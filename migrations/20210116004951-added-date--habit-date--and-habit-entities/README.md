# Migration `20210116004951-added-date--habit-date--and-habit-entities`

This migration has been generated by Caitlin Tibbetts at 1/15/2021, 6:49:51 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "Date" (
    "at" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY ("at")
)

CREATE TABLE "HabitDate" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "habitName" TEXT NOT NULL,
    "dateAt" DATETIME NOT NULL,
    "finished" BOOLEAN NOT NULL DEFAULT false,

    FOREIGN KEY ("habitName") REFERENCES "Habit"("name") ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY ("dateAt") REFERENCES "Date"("at") ON DELETE CASCADE ON UPDATE CASCADE
)

CREATE TABLE "Habit" (
    "name" TEXT NOT NULL,
    PRIMARY KEY ("name")
)
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210116002919-added-hdate-list-to-habit..20210116004951-added-date--habit-date--and-habit-entities
--- datamodel.dml
+++ datamodel.dml
@@ -1,24 +1,30 @@
 datasource db {
   provider = "sqlite"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
   output = "../server/node_modules/.prisma/client"
 }
-model HDate {
+model Date {
+    at DateTime @id @default(now())
+  hDates HabitDate[]
+}
+
+model HabitDate {
     id  Int @id @default(autoincrement())
   Habit Habit @relation(fields: [habitName], references: [name])
   habitName String
-  at DateTime @default(now())
+  Date Date @relation(fields: [dateAt], references: [at])
+  dateAt DateTime
   finished  Boolean @default(false)
 }
 model Habit {
     name String @id
-  dates HDate[]
+  hDates HabitDate[]
 }
```


